@model  AlfaPeople.KingKhaledFoundation.Admin.Web.Models.WorkshopResultDto
@{
    ViewBag.Title = Resources.WorkshopReport.Title;
}

<link href="~/Content/chosen.min.css" rel="stylesheet" />

<div class="content">
    <div class="container-fluid">
        <div class="row">
            <div class="col-md-12">
                <div class="card ">
                    <div class="card-header card-header-rose card-header-text">
                        <div class="card-text">
                            <h4 class="card-title">@Resources.WorkshopReport.Title</h4>
                        </div>
                    </div>
                    <div class="card-body ">
                        @using (Html.BeginForm("WorkShops", "Reports", FormMethod.Post, new { @name = "myDropzone", id = "myDropzone", @enctype = "multipart/form-data" }))
                        {
                            @Html.AntiForgeryToken()
                            @Html.ValidationSummary(true, "", new { @class = "text-danger" })
                            <div class="row justify-content-center">

                                <div class="col-lg-6">
                                    <div class="form-group">
                                        <label for="DateFrom" class="bmd-label-floating">@Resources.WorkshopReport.DateFrom </label>
                                        @Html.TextBoxFor(model => model.SearchDto.DateFrom, htmlAttributes: new { @class = "form-control ", @id = "DateFrom" })


                                    </div>
                                </div>
                                <div class="col-lg-6">
                                    <div class="form-group">
                                        <label for="DateTo" class="bmd-label-floating">@Resources.WorkshopReport.DateTo </label>
                                        @Html.TextBoxFor(model => model.SearchDto.DateTo, htmlAttributes: new { @class = "form-control ", @id = "DateTo" })
                                    </div>
                                </div>

                                <div class="col-lg-6">
                                    <div class="form-group">
                                        <label>@Resources.WorkshopReport.Workshop</label>
                                        @Html.DropDownListFor(model => model.SearchDto.IncubationWorkshopId, (SelectList)ViewBag.IncubationWorkShops, new { @class = "select-wizard form-control selectpicker", data_style = "select-with-transition", @id = "Governorate", @title = Resources.WorkshopReport.Workshop })

                                    </div>
                                </div>

                                <div class="col-lg-6">
                                    <div class="form-group">
                                        <label for="SearchDto_Gender"> @Resources.WorkshopReport.Gender</label>
                                        @Html.EnumDropDownListFor(model => model.SearchDto.Gender, new { @class = "select-wizard form-control selectpicker", data_style = "select-with-transition", @title = Resources.WorkshopReport.Gender })
                                    </div>
                                </div>

                                <div class="col-lg-6">
                                    <div class="form-group">
                                        <label for="SearchDto_GovernateId" class="bmd-label-floating">@Resources.WorkshopReport.Governorate</label>
                                        @Html.DropDownListFor(model => model.SearchDto.GovernateId, (SelectList)ViewBag.Governates, new { @class = "select-wizard form-control selectpicker", data_style = "select-with-transition", @title = Resources.WorkshopReport.Governorate })
                                    </div>
                                </div>

                                <div class="col-lg-6">
                                    <div class="form-group">
                                        <label for="SearchDto_GovernateId" class="bmd-label-floating">@Resources.WorkshopReport.Consultant</label>
                                        @Html.DropDownListFor(model => model.SearchDto.GovernateId, (SelectList)ViewBag.Consultants, new { @class = "select-wizard form-control selectpicker", data_style = "select-with-transition", @title = Resources.WorkshopReport.Consultant })
                                    </div>
                                </div>

                                <div class="col-lg-6">
                                    <div class="form-group">
                                        <label for="SearchDto_CorporateId" class="bmd-label-floating">@Resources.WorkshopReport.Corporate</label>
                                        @Html.DropDownListFor(model => model.SearchDto.CorporateId, (SelectList)ViewBag.Corporations, new { @class = "select-wizard form-control selectpicker", data_style = "select-with-transition", @title = Resources.WorkshopReport.Corporate })
                                    </div>
                                </div>
                                <div class="col-lg-6">
                                    <div class="form-group">
                                        <label for="SearchDto_IncubationWorkshopModelId" class="bmd-label-floating">@Resources.WorkshopReport.WorkshopModel</label>
                                        @Html.DropDownListFor(model => model.SearchDto.IncubationWorkshopModelId, (SelectList)ViewBag.IncubationWorkShopModels, new { @class = "select-wizard form-control selectpicker", data_style = "select-with-transition", @title = Resources.WorkshopReport.WorkshopModel })
                                    </div>
                                </div>
                                <div class="col-lg-6">
                                    <div class="form-group">
                                        <label for="SearchDto_ProjectSuccessRate"> @Resources.WorkshopReport.ProjectSuccessRate</label>
                                        @Html.EnumDropDownListFor(model => model.SearchDto.ProjectSuccessRate, new { @class = "select-wizard form-control selectpicker", data_style = "select-with-transition", @title = Resources.WorkshopReport.ProjectSuccessRate })
                                    </div>
                                </div>

                                <div class="col-lg-6">
                                </div>

                                <div class="col-lg-12">
                                    <div class="card-footer justify-content-center ">
                                        <input type="submit" id="submit" class="btn btn-rose" name="submit" value="@Resources.General.View">
                                    </div>
                                </div>
                            </div>
                        }
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="card-body" style="direction: @Resources.General.dir;text-align: @Resources.General.TextAlign;">
        <div class="toolbar">
            <button class="" id="export" onclick="Export()">@Resources.General.Export</button>
            <button class="" onclick="PrintTable()">@Resources.General.Print</button>
        </div>
        <div class="material-datatables">
            <table id="datatables" class="table table-striped table-no-bordered table-hover" cellspacing="0"
                   width="100%" style="width:100%">
                <thead id="header">
                    <tr>
                        <th width="20%">
                            @Resources.WorkshopReport.Workshop
                        </th>
                        <th width="15%">
                            @Resources.WorkshopReport.WorkshopModel
                        </th>
                        <th width="0%">
                            @Resources.WorkshopReport.Governorate
                        </th>
                        <th width="10%">
                            @Resources.WorkshopReport.Consultant
                        </th>
                        <th width="0%">
                            @Resources.WorkshopReport.TargetCount
                        </th>
                        <th width="0%">
                            @Resources.WorkshopReport.CountOfConfirmations
                        </th>
                        <th width="0%">
                            @Resources.WorkshopReport.CountOfPartcipation
                        </th>
                        <th width="15%">
                            @Resources.WorkshopReport.Corporate
                        </th>
                        <th width="10%">
                            @Resources.WorkshopReport.Attender
                        </th>
                        <th width="0%">
                            @Resources.WorkshopReport.Gender
                        </th>
                        <th width="15%">
                            @Resources.WorkshopReport.Position
                        </th>
                        <th width="15%">
                            @Resources.WorkshopReport.EducationalQualificationAndSpecialization
                        </th>
                    </tr>
                </thead>
                <tbody id="body">
                    @foreach (var item in Model.Results)
                    {
                        <tr>
                            <td>
                                @Html.DisplayFor(modelItem => item.WorkshopName)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.WorkshopModelName)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.GovernorateName)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.ConsultantName)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.CountOfAdventages)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.CountOfConfirmed)
                            </td>

                            <td>
                                @Html.DisplayFor(modelItem => item.CountOfPartcipation)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.CorporationName)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.Attender)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.Gender)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.Position)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.Qualification)
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
    </div>
</div>

@section Scripts{
    <script>
        window.onload = function (e) {
            $('#navItem_WorkShops').addClass('active');
            $('#cbReports').addClass('show');
        };
    </script>

    <script>
        $(document).ready(function () {
            $("#DateFrom").datepicker({
                changeYear: true,
                dateFormat: 'yy-mm-dd',
                altFormat: "yy-mm-dd"
            });

            $("#DateTo").datepicker({
                changeYear: true,
                dateFormat: 'yy-mm-dd',
                altFormat: "yy-mm-dd"
            });

            $("#DateFrom").datepicker({ dateFormat: 'yy-mm-dd' }).bind("change", function () {
                var minValue = $(this).val();
                minValue = $.datepicker.parseDate("yy-mm-dd", minValue);
                minValue.setDate(minValue.getDate());
                $("#DateTo").datepicker("option", "minDate", minValue);
            });
        });
    </script>

    <script>
        function Export() {
            window.location = '/Reports/Download?fileGuid=@Model.FileGuid';
            document.getElementById('export').disabled = true;
        }

        function PrintTable() {
            PrintElem('header', 'body');
        }

        function PrintElem(elem1, elem2) {

            var mywindow = window.open('', 'PRINT', 'height=750,width=750');
            mywindow.document.write('<html>');
            mywindow.document.write('<head>');
            mywindow.document.write('<title>' + document.title + '</title>');
            mywindow.document.write('<link rel="stylesheet" type="text/css" href="../assets/css/css.css" />');
            mywindow.document.write('<style type="text/css">');
            mywindow.document.writeln('table.test, table.test th, table.test td { text-align: center;padding:5px;border: 1px solid black;border-collapse: collapse;}');
            mywindow.document.write('table.report-container { page-break-after: always; }');
            mywindow.document.write('thead.report-header { display: table-header-group; }');
            mywindow.document.write('tfoot.report-footer { display: table-footer-group; }');
            mywindow.document.writeln('@@media print { @@page { size: portrait; /* landscape */ margin: 0in 0.14in 0in 0.14in; }}');
            mywindow.document.write('</style>')
            mywindow.document.write('</head>');

            mywindow.document.write('<body @if (AlfaPeople.KingKhaledFoundation.Admin.Web.Helper.CultureHelper.CurrentCulture == 3) {<TEXT>style="direction: @Resources.General.dir;text-align: @Resources.General.TextAlign;font-family: Suisse, Mabry;"</TEXT>} else {<TEXT>style="direction: @Resources.General.dir;text-align: @Resources.General.TextAlign;font-family: Mabry, Suisse;"</TEXT>} >');

            mywindow.document.write('<table class="report-container">');
            mywindow.document.write('<thead class="report-header"><tr><th class="report-header-cell"><div style="text-align: @Resources.General.TextAlign;" class="header-info">');
            mywindow.document.write('<img src="../assets/img/PrintLogo.png" />')
            mywindow.document.write('<h2 style="text-align: center;">@Resources.WorkshopReport.Title</h2>');
            mywindow.document.write('<hr style="border: 1px double black;width: 30%;position: relative;top: -17px;" />');
            mywindow.document.write('</div></th></tr></thead>');

            mywindow.document.write('<tbody class="report-content"><tr><td class="report-content-cell"><div class="main">');
            mywindow.document.write('<table class="test" cellspacing="0" width="100%" style="width:100%; font-size: 12px;">');
            mywindow.document.write('<thead>');
            mywindow.document.write(document.getElementById(elem1).innerHTML);
            mywindow.document.write('</thead>');
            mywindow.document.write(document.getElementById(elem2).innerHTML);
            mywindow.document.write('</table>');
            mywindow.document.write('</div></td></tr></tbody>');

            mywindow.document.write('<tfoot class="report-footer"><tr><td style="padding: 14px; text-align: center; border-top: 3px double #e7e7e7;position: fixed;top: 95%;width: 100%;" class="report-footer-cell"><div class="footer-info">');
            mywindow.document.write('<footer class="footer">@Resources.General.AllRightsReserved</footer>');
            mywindow.document.write('</div></td></tr></tfoot>');
            mywindow.document.write('</table>');

            mywindow.document.write('</body>');
            mywindow.document.write('</html>');

            mywindow.document.close(); // necessary for IE >= 10
            mywindow.focus(); // necessary for IE >= 10*/
            mywindow.print();
            //mywindow.close();
        }
    </script>
    <script>
        $(document).ready(function () {
            $('form').one('submit', function () {
                $(this).find("input[type='submit']").prop('disabled', true);
                $(this).find('input[type="submit"]').attr('disabled', 'disabled');
                $(this).find("button[type='submit']").prop('disabled', true);
                $(this).find('button[type="submit"]').attr('disabled', 'disabled');
            });
            $('form').submit(function () {
                $(this).find("input[type='submit']").prop('disabled', true);
                $(this).find('input[type="submit"]').attr('disabled', 'disabled');
                $(this).find("button[type='submit']").prop('disabled', true);
                $(this).find('button[type="submit"]').attr('disabled', 'disabled');
            });
            $('input').focusout(function () {
                if ($(this).val() != '') {
                    $(':input[type="submit"]').prop('disabled', false);
                    $(':button[type="submit"]').prop('disabled', false);

                    $(':input[type="submit"]').removeAttr('disabled');
                    $(':button[type="submit"]').removeAttr('disabled');
                }
            });
            $('select').change(function () {
                if ($(this).val() != '') {
                    $(':input[type="submit"]').prop('disabled', false);
                    $(':button[type="submit"]').prop('disabled', false);

                    $(':input[type="submit"]').removeAttr('disabled');
                    $(':button[type="submit"]').removeAttr('disabled');
                }
            });
            $('textarea').focusout(function () {
                if ($(this).val() != '') {
                    $(':input[type="submit"]').prop('disabled', false);
                    $(':button[type="submit"]').prop('disabled', false);

                    $(':input[type="submit"]').removeAttr('disabled');
                    $(':button[type="submit"]').removeAttr('disabled');
                }
            });
        });
    </script>
}